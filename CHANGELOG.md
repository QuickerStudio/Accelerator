# CHANGELOG

## [v0.2.0] - 2026-03-02

### 新增功能 ✨

#### 笔记拖拽分类功能
- **拖拽交互**
  - 长按笔记卡片触发拖拽（使用 `detectDragGesturesAfterLongPress`）
  - 拖拽预览层跟随手指移动
  - 拖拽时原卡片变透明，内容隐藏
  - 半透明预览卡片（透明度 0.9）

- **悬停反馈**
  - 拖拽到分组卡片上时，分组变绿色高亮（#10B981）
  - 实时检测手指位置是否在分组区域内
  - 视觉反馈清晰直观

- **自动更新分组**
  - 松手时自动更新笔记的分组关联
  - 无需弹窗确认，操作流程简化为 2 步
  - 支持拖拽到任意分组

- **技术实现**
  - 创建 `DragDropState` 类管理拖拽状态
  - 使用 `LocalDensity.toDp()` 正确转换像素到 dp
  - 坐标系转换：屏幕绝对坐标 → Box 内相对坐标
  - 拖拽预览层放在笔记列表 Box 内，确保正确的层级关系

#### 侧边栏功能
- **侧边栏基础结构**
  - 宽度 300dp，从左侧滑入/滑出（300ms 动画）
  - 半透明黑色遮罩层，点击关闭侧边栏
  - 适配状态栏高度
  - 白色主题设计

- **搜索功能**
  - 搜索框从右向左滑入（600ms 动画）
  - "Accelerator" 文字逐个字符消失动画（每个字符延迟 50ms）
  - 搜索框胶囊形状（圆角 20dp），高度 40dp
  - 搜索框有内容时按钮变绿色
  - 智能搜索：有内容时执行搜索，无内容时切换模式

- **笔记编辑器**
  - 创建 Note 数据模型和 NoteManager 管理器
  - 标题和内容输入框
  - 空内容保存提示（红色警告文字）
  - 编辑器状态持久化（关闭侧边栏不丢失内容）
  - 点击新建笔记按钮进入编辑器
  - 点击笔记卡片编辑已有笔记
  - 只显示有内容的笔记

- **全部笔记区域**
  - 深绿色圆角方形新建按钮（32dp）
  - 笔记卡片 100x120dp（高度大于宽度）
  - 按时间戳倒序排列
  - 排序切换按钮（正序/倒序）
  - 水平滚动列表

- **笔记分组区域**
  - 排序切换按钮
  - 添加分组按钮
  - 分组卡片水平滚动
  - 10 个示例分组

- **单词学习日志**
  - 置顶分类（默认展开，有背景）
  - 今天分类（默认展开，无背景）
  - 本周分类（默认折叠，无背景）
  - 更早分类（始终展开，有背景）
  - 可折叠功能，箭头旋转动画

- **设置按钮跳转**
  - 点击设置按钮跳转到设置页
  - 自动关闭侧边栏
  - 完成侧边栏与底部导航联动

### 技术改进 🔧

#### 状态管理优化
- 编辑器状态提升到页面组件
- 状态持久化，关闭侧边栏不丢失
- 清晰的回调传递机制

#### 动画效果
- 侧边栏滑入/滑出动画
- 文字逐个消失动画
- 箭头旋转动画
- 搜索框滑入动画

### 修复 🐛

- 修复编辑器状态持久化问题
- 修复搜索框垂直对齐问题
- 修复搜索框滑入速度过快问题
- 修复笔记排序问题

### 样式优化 🎨

- 新建笔记按钮改为深绿色
- 搜索框胶囊形状设计
- 排序按钮紧贴标题
- 笔记卡片尺寸优化

### 数据 📊

- 新增文件：3 个（Sidebar.kt、NoteEditor.kt、Note.kt）
- 修改文件：4 个
- 代码行数：约 500+ 行
- Git 提交：约 10 次

---

## [v0.1.0] - 2026-03-02

### 新增功能 ✨

#### 核心功能
- **单词卡片系统**
  - 实现单词卡片 UI，显示单词、音标、释义和例句
  - 卡片尺寸 560dp，圆角 24dp，带阴影效果
  - 白色背景适配浅色主题

- **卡片堆叠与滑动交互**
  - 3张卡片堆叠效果，后面的卡片向右偏移 6dp，向下偏移 10dp
  - 支持左滑/右滑切换单词（超过屏幕宽度 30% 触发）
  - 平滑的飞出和回弹动画
  - 滑动时卡片带轻微旋转效果

- **长按收藏功能**
  - 长按单词卡片（500ms）触发收藏
  - 震动反馈提升用户体验
  - 收藏本页面显示所有收藏的单词
  - 支持删除收藏（右上角 X 按钮）

- **自定义 Toast 提示**
  - 左滑"未记住" - 浅红色背景 (#FEE2E2)
  - 右滑"已记住" - 浅绿色背景 (#DCFCE7)
  - 长按"已收藏" - 浅蓝色背景 (#DEEDFF)
  - Toast 位于单词卡片上方 20dp
  - 自动在 1.5 秒后淡出消失

#### 导航系统
- **底部导航栏**
  - 4个导航按钮：单词、写作、对话、设置
  - Material3 简约设计风格
  - 支持选中/未选中状态切换

- **顶部导航栏**
  - 左侧菜单按钮（圆形背景）
  - 右侧对话按钮 + 收藏本按钮（胶囊背景）
  - 对话按钮支持 toggle 切换，激活时显示深灰色背景

#### 交互功能
- **底部输入区域**
  - 胶囊背景设计，圆角 28dp
  - 包含相机、文本输入框、上传、发送按钮
  - 按钮悬浮在输入框上层
  - 支持最多 2 行文本输入
  - 发送按钮根据输入状态改变颜色

- **对话模式切换**
  - 点击对话按钮显示/隐藏输入区域
  - 单词卡片位置动态调整
  - 平滑的滑入/滑出动画

- **键盘管理**
  - 点击卡片区域空白处隐藏键盘
  - 提升输入体验

### 技术改进 🔧

#### 架构优化
- 采用 MVVM 架构模式
- 组件化设计，高度可复用
- 清晰的状态管理

#### 动画效果
- 使用 `animateDpAsState` 实现平滑的尺寸动画
- 使用 `Animatable` 实现复杂的滑动动画
- 使用 `AnimatedVisibility` 实现淡入淡出效果

#### 用户体验
- 触觉反馈（震动）
- 视觉反馈（颜色变化、Toast 提示）
- 流畅的动画过渡
- 直观的手势交互

### 修复 🐛

- 修复单词卡片位置偏上的问题，调整底部内边距实现视觉居中
- 修复底部输入区域位置不正确的问题，移到 MainActivity 的 Scaffold bottomBar
- 修复键盘无法隐藏的问题，添加点击空白区域隐藏键盘功能
- 修复 Toast 位置不正确的问题，多次调整达到最佳视觉效果
- 修复输入区域按钮布局拥挤的问题，改为悬浮按钮设计
- 修复多次编译错误，添加缺失的导入语句

### 样式优化 🎨

- 单词卡片文字颜色优化（主文本 #1E293B，次要文本 #64748B）
- 底部输入区域背景色加深（#F1F5F9 → #E2E8F0）
- Toast 提示样式优化（宽度 200dp，文字居中，带阴影）
- 按钮间距优化（15dp）
- 顶部栏适配状态栏高度

### 数据 📊

- 新增文件：约 15 个
- 代码行数：约 1500+ 行
- Git 提交：约 20 次
- 主要语言：Kotlin
- UI 框架：Jetpack Compose

### 已知问题 ⚠️

以下功能尚未实现，将在后续版本中添加：

- 侧边栏功能
- 对话模式实际功能（相机、上传、发送按钮）
- 单词发音播放（TTS 服务）
- 数据持久化（Room 数据库）
- 单词学习进度追踪
- 动态加载单词列表

### 依赖 📦

- Kotlin 2.0.21
- Jetpack Compose BOM 2025.07.00
- Material3
- Material Icons Extended
- Android Gradle Plugin 9.0.0

---

## 下一步计划 🚀

- [ ] 实现数据持久化（Room 数据库）
- [ ] 集成 TTS 服务实现单词发音
- [ ] 实现侧边栏功能
- [ ] 完善对话模式的实际功能
- [ ] 添加单词学习进度追踪
- [ ] 优化性能和内存使用

---

**版本说明**：本版本为单词学习模块的初始版本，实现了核心的 UI 和交互功能，为后续功能开发奠定了基础。
笔记分组功能设计
核心概念
笔记分组卡片 = Toggle 按钮（用于筛选笔记）
全部笔记 = 所有笔记的集合
交互逻辑
长按笔记卡片 + 拖拽

长按"全部笔记"中的笔记卡片
拖拽到某个"笔记分组卡片"上
该笔记就被归类到这个分组中
点击笔记分组卡片（Toggle 功能）

第一次点击：只显示该分组中的笔记
再次点击：显示全部笔记（取消筛选）
视觉状态

未选中状态：显示全部笔记
选中状态：只显示该分组的笔记（分组卡片高亮显示）
举个例子
你有 10 个笔记
你长按"笔记1"拖到"工作"分组
你长按"笔记2"拖到"工作"分组
点击"工作"分组卡片 → 只显示"笔记1"和"笔记2"
再次点击"工作"分组卡片 → 显示全部 10 个笔记